<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
	<title>Second heart attack prediction</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
</head>

<body class="is-preload">

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Main -->
		<div id="main">
			<div class="inner">

				<!-- Header -->
				<header id="header">
					<a href="index.html" class="logo"></a>
					<ul class="icons">
						<li><a href="https://github.com/leticia8/portofliollado" class="icon brands fa-github"><span
									class="label">Git Hub</span></a></li>
						<li><a href="https://www.linkedin.com/in/leticia-lado-50b7a5106/"
								class="icon brands fa-linkedin"><span class="label">Linked In</span></a></li>
					</ul>
				</header>

				<!-- Content -->
				<section>
					<header class="main">
						<h2>Second heart attack prediction</h2>
					</header>

					<p style="font-size:18px"> Training used data:<a href="files/cardiac-training"> data
						cardiology training set</a>

					<p style="font-size:18px"> Test used data: <a href="files/cardiac-scoring">data
						cardiology test set</a>

						<hr class="major" />
					<p style="font-size:20px ;text-align:justify"> This data set consists of information from
						patients: <br>
						
						In the first place, following the CRISP-DM model, we proceed to understand the area of study which refers to measurements of different variables <br>
						of cardiological patients. The cardiologist wants to have a system that allows him infer from observed patient data whether
						there is a risk of suffering a new heart attack or not. It has historical data of patients and variables
						measures that are scientifically used as proxy indicators for predict coronary heart disease.
						The doctor has in his registry with historical information of patients who suffered a heart attack
						and therefore there is data that it already has labeled because the patients died (already
						confirm the possibility of suffering a new heart attack or not). Therefore we are faced with a problem
						supervised. <br>
						On the other hand, we want to determine a classification of patients into two groups, those who
						they are at risk of having a 2nd heart attack and those that don't, so we are facing a classification problem. <br>
						We will first proceed to the understanding of the data, we observe the measured attributes and their
						meaning: <br><br>

						<!DOCTYPE html>
						<html>

						<head>
							<style>
								table,
								th,
								td {
									border: 2px solid black;
								}
							</style>
						</head>

						<body>
							<table>
								<tr>
									<th>
										<p style="font-size:18px">Attribute
									</th>
					</p>
					<th>
						<p style="font-size:18px">Type
					</th>
					<th>
						<p style="font-size:18px">Range
					</th>
					</tr>
					<tr>
						<td><strong>Civil status:</strong> Values: 0 = single; 1 = married, 2 = divorced and
							3 = widower.</td>
						<td>Categorical</td>
						<td>0-3</td>
					</tr>
					<td>
						<p><strong>Sex:</strong> Values: 0 = female; 1= male.</p>
					</td>
					<td> Categorical - dummy</td>
					<td>0-1</td>
					</tr>
					<td>
						<p><strong>Category_Weight:</strong> Values: 0 = normal; 1 = overweight; 2 = obese.</p>
					</td>
					<td>Categorical in numbers</td>
					<td>0-2</td>
					</tr>
					<td>
						<p><strong>Cholesterol:</strong> cholesterol level of the person, as recorded in
							the time of treatment indicated when your most recent heart attack.</p>
					</td>
					<td>Continuous</td>
					<td>122 - 239</td>
					</tr>
					<td>
						<p><strong>Handling_stress: </strong> Indicates if the patient has previously participated in courses
							stress management: 0 = no; 1 = yes.</p>
					</td>
					<td>Categorical - dummy</td>
					<td>0-1</td>
					</tr>
					<td>
						<p><strong>Trat_anxiety:</strong> Attribute that takes values of type integer between 0 and 100
							indicative of each person's natural stress level and ability to handle it.
						</p>
					</td>
					<td>Categorical understood as continuous</td>
					<td>35-80</td>
					</tr>
					</table>
</body>

</html>

<p style="font-size:20px ;text-align:justify"> Regarding the Trat_anxiety variable, it results from a test applied to the
	patient after suffering 1st heart attack,
	Each patient was administered a standard natural anxiety test.  <br>
	The values are tabulated in increments of 5. A value of 0 would indicate that the person never feels anxiety,
	pressure or stress in any situation, while a value of 100 would indicate that the person lives in a continuous state of overload and unable to cope with their situation. <br>

	The <strong> 2nd_Attack_Heart </strong> attribute exists only in the training dataset. It is the variable
		target or prediction (“label” in RapidMiner).
		In the training dataset, this attribute contains "Yes" for those individuals who have suffered a second
		heart attack, and "No" otherwise.  <br>


		Once the attributes are analyzed, the factors that can modify any model are studied in more detail, specially
		their ranges, missing values and outliers. <br>
		We see below the summary of statistics offered by RapidMiner: <br>
		
		
	<img title="tabla" src="images/p2_pdatos.JPG" style="width:90%;height:50%;" alt="" /><br>
	As can be seen in this image, the 0s indicate that there are no missing attributes,
	the ranges do not denote abnormal values (outliers) in fact the averages and deviations of each column are
	find enough adjusted to average. <br>

	The possible correlations that may exist between them are observed in the case of applying algorithms such as
	Logistic Regression or Sensitive Naive Bayes
	to the correlations between the variables. <br>
	For example, possible high correlations between stress management and anxiety treatment could be identified
	and there are also studies that link cholesterol levels with stress factors as well as with the sex of the
	person. <br>
	
	For the data of our data set, however, there do not appear to be significant correlations: <br>


	<img title="matriz" src="images/p2_mcorr.JPG" style="width:90%;height:50%;" alt="" /><br> <br>

	The highest record is observed in age and anxiety treatment, as well as weight and cholesterol category with
	anxiety treatment, but they are low non-significant values that justify a removal of the attribute from the model. <br>

	If we apply a principal components analysis (since all our variables are numerical we can do it
	easily)	we observe the following table of eigenvalues: <br>


	<img title="matriz" src="images/p2_pca.PNG" style="width:100%;height:50%;" alt="" /><br> <br>

	It is observed that the first two main components explain 97.7% of the variance of the model, if we look for
	within the eigenvectors:

	<img title="matriz" src="images/p2_pca2.PNG" style="width:100%;height:50%;" alt="" /><br> <br>

	It is observed that the first component has a very high cholesterol weight, which is logical with the recommendations
	usual medical to control this risk factor. <br>
	The second component has a great weight of the anxiety treatment variable in a negative way, which it would not have
	a lot of logic to simple view given that it would indicate higher anxiety scores in the test lower risk of suffering a second attack, but
	in these cases is when the existence of possible correlated variables must be understood, that is, it could establish the
	hypothesis that more anxious people tend to discharge this energy by doing, for example, exercise which would be good for
	health and it would be correlated with this variable. <br>
	On the other hand, the second attribute that makes up the second main component is Age, negatively, although in
	this case the weight importance is reduced. <br>
	The proportion of the accumulated variance by principal components is observed in the following image: <br>


	<img title="matriz" src="images/p2_pcaCurve.PNG" style="width:100%;height:50%;" alt="" /><br> <br>

	Something important to do is the normalization of the data so that the ranges of variation of the same are not
	very dissimilar 	especially since algorithms like LDA or Naive Bayes assume normal distributions. <br>

	In the models of rapid miner the operators of SVM, Logistic Regression offer to carry out the standardization as
	adjustable node parameter. <br>
	Before deciding which operator to use, we are going to observe with a ROC Curve the performance of the different
	models. <br>
	In the reference problem we are interested in a good prediction of the True Positive even if there is False
	Positive since it would not have
	a detriment to the patient taking care of himself, exercising, eating healthy. Likewise, as in any model, the ideal is that
	FP = 0. <br>
	In this case, as it is not used for a specific diagnosis (such as cancer cases) but to have the information to carry out more frequent checks and
	emphasis on patient care. <br>
	We observe the ROC curve obtained by testing the Random Forest, SVM, Logistic Regression and Naive Bayes models: <br>

	<img title="matriz" src="images/p2_rocCurve.PNG" style="width:100%;height:50%;" alt="" /><br> <br>

	As seen, Random Forest presents a better performance for the TPs at the beginning of the model, then they all stabilize
	presenting good final performances. <br>

	We will measure the performance of these four methods and observe the results using the cross-validation node
	with 10 folds and a random sampling of the data used for training and validation. <br>
	Within the cross validation, the four models are applied and their performance is measured. <br>

	The following performance is obtained for the models: <br> <br>



	

	LOGISTIC REGRESSION<br>
	<img src="images/p2_logReg.PNG" style="width:100%;height:50%;" alt="" /> <br>

	SVM <br>
	<img src="images/p2_svm.PNG" style="width:100%;height:50%;" alt="" /> <br>

	NAIVE BAYES <br>
	<img src="images/p2_naive.PNG" style="width:100%;height:50%;" alt="" /> <br>

	RANDOM FOREST <br>
	<img src="images/p2_randomF.PNG" style="width:100%;height:50%;" alt="" /> <br>



	In relation to what is observed with the ROC curve, the model that presents the best performance is Random Forest, with 97.14%
	precision.
	Followed by Logistics Regression 92.03%, Naive Bayes: 88.35% and lastly SVM 85.55%.

	Therefore, applying Random Forest to the model with 50 trees and a maximum depth of 5 (after testing various
	parameters)
	97.86% confidence is obtained:

	<br>


	<img src="images/p2_finalAcc.PNG" style="width:100%;height:50%;" alt="" />

	And the predictions on the test data:

	<img src="images/p2_apply.PNG" style="width:100%;height:50%;" alt="" /> <br>


	Which indicates that for example example 1 is a prediction of No with a confidence of 99.5%, while example 2 a
	Yes prediction with a 99.7% confidence.<br>

	Finally, the model yields the following trees from among the 50 elaborated:<br>

	Tree 1<br>

	<img src="images/p2_arbol1.PNG" style="width:80%;height:50%;" alt="" /> <br>

	Tree 2<br>
	<img src="images/p2_arbol2.PNG" style="width:80%;height:50%;" alt="" /> <br>


	Given that 50 trees may be excessive for understanding the model (one of the strengths of the
	trees decision is its simplicity to be interpreted), I reduced the number of trees to 5 obtaining a
	performance of 95.71%, that is, a decrease of more than 2 percentage points, in this case it remains to evaluate the
	investigator than to use the model the trade-off between model comprehensibility and accuracy.
</p>


</section>
</div>
</div>

<!-- Sidebar -->
<div id="sidebar">
	<div class="inner">

		<!-- Search -->
		<section id="search" class="alt">
			<form method="post" action="#">
				<input type="text" name="query" id="query" placeholder="Search" />
			</form>
		</section>
		<!-- Menu -->
		<nav id="menu">
			<header class="major">
				<h2>Menu</h2>
			</header>
			<ul>
				<li><a href="index.html">Home</a></li>
				<li><a href="introduccion.html">Introduction to Machine Learning </a></li>
				<li>
					<span class="opener" href="index.html">Theoretical framework</span>
					<ul>
						<li><a href="supervisados.html">Supervised learning</a></li>
						<ul>
							<li><a href="deRegresion.html">Regression</a></li>
							<li><a href="deClasificacion.html">Classification</a></li>
						</ul>
						<li><a href="noSupervisados.html">Unsupervised learning</a></li>
						<ul>
							<li><a href="deClustering.html">Clustering</a></li>
							<li><a href="deReduccionDim.html">Reduction of dimensions</a></li>

						</ul>
					</ul>
				</li>
				<li>
					<span class="opener" href="proyectos.html">Projects</span>
					<ul>
						<li><a href="proyectoUno.html">Home price prediction </a></li>
						<li><a href="proyectoDos.html">Cardiology prediction</a></li>

						<li><a href="proyectoCuatro.html"> Height prediction from skeletal remains</a></li>
						<li><a href="proyectoTres.html">Prediction of patients with / without liver</a></li>
						<li><a href="proyectoCinco.html">Prediction of autism in adults</a></li>



					</ul>
				</li>

			</ul>
		</nav>

	</div>
</div>

</div>

<!-- Scripts -->
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/browser.min.js"></script>
<script src="assets/js/breakpoints.min.js"></script>
<script src="assets/js/util.js"></script>
<script src="assets/js/main.js"></script>

</body>

</html>